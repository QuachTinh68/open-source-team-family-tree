<!DOCTYPE html>
<html lang="vn" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<!-- Main Head -->
<head th:replace="fragments :: page_head('Trang chủ', 'none')"></head>

<body class="nk-body bg-white npc-default has-aside ">
    <div class="nk-app-root">
        <!-- main @s -->
        <div class="nk-main ">
            <!-- wrap @s -->
            <div class="nk-wrap ">
                <div th:replace="common/headerLD :: headerLD"></div>
                <!-- main header @e -->
                <!-- content @s -->
                <div class="nk-content">
                    <div class="container wide-xl pt-4 pb-4">
                        <div class="nk-content-inner">
                            <div class="nk-content-body">
                                <div class="nk-content-wrap">
                                    <div class="nk-block-head nk-block-head-sm">
                                        <div class="nk-block-between">
                                            <div class="nk-block-head-content">
                                                <h3 class="nk-block-title page-title">Tài khoản của tôi</h3>
                                            </div><!-- .nk-block-head-content -->
                                        </div><!-- .nk-block-between -->
                                    </div><!-- .nk-block-head -->
                                    <div class="nk-block">
                                        <div class="card card-bordered">
                                        <div class="card-aside-wrap">
                                            <div class="card-inner card-inner-lg">
                                                <div class="nk-block-head nk-block-head-lg">
                                                    <div class="nk-block-between">
                                                        <div class="nk-block-head-content">
                                                            <h4 class="nk-block-title">Thông tin tài khoản</h4>
                                                        </div>
                                                    </div>
                                                </div><!-- .nk-block-head -->
                                                <div class="nk-block">
                                                    <div class="nk-data data-list">
                                                        <div class="data-head">
                                                            <h6 class="overline-title">Cơ bản</h6>
                                                        </div>
                                                        <div class="data-item">
                                                            <div class="data-col">
                                                                <span class="data-label">Họ tên</span>
                                                                <span class="data-value">[[${user.name}]]</span>
                                                            </div>
                                                        </div><!-- data-item -->
                                                        <div class="data-item">
                                                            <div class="data-col">
                                                                <span class="data-label">Số điện thoại</span>
                                                                <span class="data-value">[[${user.phone}]]</span>
                                                            </div>
                                                        </div><!-- data-item -->
                                                        <div class="data-item">
                                                            <div class="data-col">
                                                                <span class="data-label">Email</span>
                                                                <span class="data-value">[[${user.email}]]</span>
                                                            </div>
                                                        </div><!-- data-item -->
                                                        <div class="data-item">
                                                            <div class="data-col">
                                                                <span class="data-label">Giới tính</span>
                                                                <span class="data-value text-soft">[[${user.genderFomat}]]</span>
                                                            </div>
                                                        </div><!-- data-item -->
                                                        <div class="data-item">
                                                            <div class="data-col">
                                                                <span class="data-label">Ngày sinh</span>
                                                                <span class="data-value">[[${user.birthDay}]]</span>
                                                            </div>
                                                        </div><!-- data-item -->
                                                        <div class="data-item" >
                                                            <div class="data-col">
                                                                <span class="data-label">Địa chỉ</span>
                                                                <span class="data-value">[[${user.adress}]]</span>
                                                            </div>
                                                        </div><!-- data-item -->
                                                    </div><!-- data-list -->
                                                </div><!-- .nk-block -->
                                            </div>
                                            <div class="card-aside card-aside-left user-aside toggle-slide toggle-slide-left toggle-break-lg" data-toggle-body="true" data-content="userAside" data-toggle-screen="lg" data-toggle-overlay="true">
                                                <div class="card-inner-group" data-simplebar>
                                                    <div class="card-inner">
                                                        <div class="user-card">
                                                            <div class="user-avatar bg-primary">
                                                                <img alt="user photo" th:src="@{${user.photosImagePath}}">
                                                            </div>
                                                            <div class="user-info">
                                                                <span class="lead-text">[[${user.name}]]</span>
                                                                <span class="sub-text">[[${user.email}]]</span>
                                                            </div>
                                                            <div class="user-action">
                                                                <div class="dropdown">
                                                                    <a class="btn btn-icon btn-trigger me-n2" data-bs-toggle="dropdown" href="#"><em class="icon ni ni-more-v"></em></a>
                                                                    <div class="dropdown-menu dropdown-menu-end">
                                                                        <ul class="link-list-opt no-bdr">
                                                                            <li><a href="#" data-bs-toggle="modal" data-bs-target="#profile-edit"><em class="icon ni ni-reload"></em><span>Thay đổi thông tin</span></a></li>
                                                                            <li><a th:href="@{/api/change_pass/}"><em class="icon ni ni-shield-check-fill"></em><span>Đổi mật khẩu</span></a></li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div><!-- .user-card -->
                                                    </div><!-- .card-inner -->
                                                    <div class="card-inner p-0">
                                                        <ul class="link-list-menu">
                                                            <li><a class="active" href="#"><em class="icon ni ni-user-fill-c"></em><span>Thông tin cá nhân</span></a></li>
                                                            <li><a href="#"><em class="icon ni ni-activity-round-fill"></em><span>Lịch sử hoạt động</span></a></li>
                                                            <li><a th:href="@{/api/change_pass/} + ${user.userName}"><em class="icon ni ni-lock-alt-fill"></em><span>Bảo mật</span></a></li>
                                                        </ul>
                                                    </div><!-- .card-inner -->
                                                </div><!-- .card-inner-group -->
                                            </div><!-- card-aside -->
                                        </div><!-- .card-aside-wrap -->
                                    </div><!-- .card -->
                                    </div><!-- .nk-block -->
                                </div>
                                <!-- footer @s -->
                                <!-- footer @e -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- content @e -->
            </div>
            <!-- wrap @e -->
        </div>
        <!-- main @e -->
        <footer th:replace="common/footerLD :: footerLD"></footer>
        
    <div class="modal fade" role="dialog" id="profile-edit">
        <div class="modal-dialog modal-dialog-centered modal-lg modal-xxl" role="document">
            <div class="modal-content">
                <a href="#" class="close" data-bs-dismiss="modal"><em class="icon ni ni-cross-sm"></em></a>
                <div class="modal-body modal-body-lg">
                    <h5 class="title">Cập nhật thông tin</h5>
                    <ul class="nk-nav nav nav-tabs">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#personal">Thông tin cơ bản</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#address">Hình ảnh & địa chỉ</a>
                        </li>
                    </ul><!-- .nav-tabs -->
						<form th:action="@{/api/acount}" method="post"
							enctype="multipart/form-data" th:object="${user}">
							<input type="hidden" th:field="*{id}" />
							<input type="hidden" th:field="*{userName}" />
							<div class="tab-content">
								<div class="tab-pane active" id="personal">
									<div class="row gy-4">
										<div class="col-md-6">
											<div class="form-group">
												<label class="form-label" for="name">Họ tên</label>
												<input type="text" class="form-control form-control-lg" th:field="*{name}"placeholder="Nhập tên">
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group">
												<label class="form-label" for="email">Email</label> 
												<input type="text" class="form-control form-control-lg" th:field="*{email}" readonly="readonly" disabled="disabled">
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group">
												<label class="form-label" for="phone">Số điện thoại</label> 
												<input type="text" class="form-control form-control-lg" th:field="*{phone}"placeholder="Nhập sdt">
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group">
												<label class="form-label" for="birthDay">Ngày sinh</label> 
												<input type="text" class="form-control form-control-lg date" th:field="*{birthDay}">
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group">
												<label class="form-label" for="gender">Giới tính</label> 
												<select class="form-select js-select2" th:field="*{gender}">
													<option value="M" th:selected="(${gender} == M)">Nam</option>
													<option value="F" th:selected="(${gender} == F)">Nữ</option>
												</select>
											</div>
										</div>
									</div>
								</div>
								<!-- .tab-pane -->
								<div class="tab-pane" id="address">
									<div class="row gy-4">
										<div class="col-md-12">
											<div id="myfileupload">
												<img id="thumbnail" alt="ảnh đại diện" class="img-fluid"
													width="200px" th:src="@{${user.photosImagePath}}"> 
												<label for="fileImage" class="custom-file-upload btn btn-primary">Chọn ảnh</label> 
												<input type="file" id="fileImage" name="fileImage" onchange="checkFileSize(this)"
													th:required="${user.photosImagePath == null}" accept="image/png , image/jpeg" /> 
												<input type="hidden" th:field="*{fileName}" />
											</div>
										</div>
										<div class="col-md-12">
											<div class="form-group">
												<label class="form-label" for="adress">Địa chỉ</label> 
												<input type="text" class="form-control form-control-lg" th:field="*{adress}">
											</div>
										</div>
										
									</div>
								</div>
								<!-- .tab-pane -->
								<div class="form-group pt-5 text-center">
									<button type="submit" class="btn btn-lg btn-primary">Lưu</button>
									<a href="#" id="cancelButton" class="btn btn-lg btn-warning"
										data-bs-dismiss="modal">Hủy</a>
								</div>
							</div>
							<!-- .tab-content -->
						</form>
					</div><!-- .modal-body -->
            </div><!-- .modal-content -->
        </div><!-- .modal-dialog -->
    </div><!-- .modal -->
    </div>
    <!-- JavaScript -->
    <script th:src="@{/js/bundle.js?ver=3.2.0}"></script>
    <script th:src="@{/js/scripts.js?ver=3.2.0}"></script>
    <script th:src="@{/js/commom-form.js}"></script>
	<script type="text/javascript">
		moduleURL = "[[@{/api/acount}]]";
		MAX_FILE_SIZE = 10485760;
		defaultImageThumbnailSrc = "[[@{/images/default-image.jpg}]]";
		
		$(".date").datepicker({
			format : 'dd-mm-yyyy'
		});
		
		message = '[[${message}]]';

		if (message !== null && message.trim() !== '') {
			Swal.fire('Thành công', message, 'success');
		}
	</script>
</body>

</html>